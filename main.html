<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Speech Synthesis Application</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 600px;
    }
    textarea {
      width: 100%;
      height: 120px;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    button {
      margin-top: 15px;
      padding: 8px 16px;
      cursor: pointer;
    }
    select, input[type="range"] {
      width: 100%;
    }
    .controls {
      margin-top: 10px;
    }
    #message {
      color: red;
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <h2>Text to Speech Application</h2>

  <!-- Text Input -->
  <label for="textInput">Enter Text</label>
  <textarea
    id="textInput"
    placeholder="Type something to speak..."
    aria-label="Text input for speech synthesis"
  ></textarea>

  <!-- Voice Selection -->
  <label for="voiceSelect">Select Voice</label>
  <select id="voiceSelect" aria-label="Voice selection dropdown">
    <option value="">Loading voices...</option>
  </select>

  <!-- Rate Control -->
  <label for="rate">Rate (Speed)</label>
  <input
    type="range"
    id="rate"
    min="0.5"
    max="2"
    step="0.1"
    value="1"
    aria-label="Speech rate control"
  />

  <!-- Pitch Control -->
  <label for="pitch">Pitch (Tone)</label>
  <input
    type="range"
    id="pitch"
    min="0"
    max="2"
    step="0.1"
    value="1"
    aria-label="Speech pitch control"
  />

  <!-- Buttons -->
  <div class="controls">
    <button id="speakBtn" aria-label="Start speech synthesis">Speak</button>
    <button id="stopBtn" aria-label="Stop speech synthesis">Stop</button>
  </div>

  <p id="message" role="alert"></p>

  <script>
    const textInput = document.getElementById("textInput");
    const voiceSelect = document.getElementById("voiceSelect");
    const rateInput = document.getElementById("rate");
    const pitchInput = document.getElementById("pitch");
    const speakBtn = document.getElementById("speakBtn");
    const stopBtn = document.getElementById("stopBtn");
    const message = document.getElementById("message");

    let voices = [];
    let utterance;

    // Load voices dynamically
    function loadVoices() {
      voices = window.speechSynthesis.getVoices();

      voiceSelect.innerHTML = "";

      if (voices.length === 0) {
        message.textContent = "No voices available on this device.";
        return;
      }

      voices.forEach((voice, index) => {
        const option = document.createElement("option");
        option.value = index;
        option.textContent = `${voice.name} (${voice.lang})`;
        voiceSelect.appendChild(option);
      });
    }

    // Some browsers load voices asynchronously
    window.speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();

    // Speak function
    function speakText() {
      const text = textInput.value.trim();

      if (!text) {
        message.textContent = "Please enter text to speak.";
        return;
      }

      if (voices.length === 0) {
        message.textContent = "Speech synthesis voices are not available.";
        return;
      }

      // Stop any ongoing speech
      window.speechSynthesis.cancel();

      utterance = new SpeechSynthesisUtterance(text);
      utterance.voice = voices[voiceSelect.value] || voices[0];
      utterance.rate = parseFloat(rateInput.value);
      utterance.pitch = parseFloat(pitchInput.value);

      message.textContent = "";
      window.speechSynthesis.speak(utterance);
    }

    // Stop speech
    function stopSpeech() {
      window.speechSynthesis.cancel();
    }

    // Restart speech when settings change during speech
    function restartIfSpeaking() {
      if (window.speechSynthesis.speaking) {
        speakText();
      }
    }

    speakBtn.addEventListener("click", speakText);
    stopBtn.addEventListener("click", stopSpeech);

    voiceSelect.addEventListener("change", restartIfSpeaking);
    rateInput.addEventListener("input", restartIfSpeaking);
    pitchInput.addEventListener("input", restartIfSpeaking);
  </script>

</body>
</html>
